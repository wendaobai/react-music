webpackJsonp([9],{742:function(t,e,o){function s(t){o(904)}var a=o(4)(o(804),o(953),s,null,null);t.exports=a.exports},804:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=o(22),a=o.n(s);e.default={data:function(){return{props:{value:"catId",label:"catName"},cateId:[],cateId2:[],msgList:[],skuUploadCount:0,spuUploadCount:0,loading:!1,loading2:!1,searchForm:{fileName:"",uploadStatus:"",page:1,rows:10},goodsList:[],total:0,dialogMsg:!1,msgFaile:[],dialogMsgImg:!1,msgImgFaile:[],dialogProgress:!1,progressMsg:"",progressId:"",progressSetInterval:"",freightList:[]}},filters:{dateFormat:function(t){return t?a()("yyyy-MM-dd hh:mm",new Date(t)):""},uploadStatus:function(t){switch(t){case 0:return"等待处理";case 1:return"数据处理中";case 2:return"导入完成";case 3:return"取消";case 4:return"上传失败"}}},methods:{success:function(t,e,o){if(this.msgList=[],"10000"==t.head.code)this.$message({type:"success",message:"导入完成，详细信息请点击商品导入列表“查看”按钮"}),this.getGoodsList();else{for(var s in o)e.uid==o[s].uid&&o.splice(s,1);this.$message({type:"error",message:t.body.sub_msg})}},error:function(t,e,o){this.$message({message:"上传失败",type:"warning"})},getGoodsList:function(){var t=this;this.loading2=!0,this.searchForm.catId=this.cateId2[this.cateId2.length-1],this.axios.post(this.myConfig.code.proxy+"/goods-upload/api/goods/upload/info",{body:this.searchForm}).then(function(e){var o=e.data;"10000"==o.head.code&&(t.loading2=!1,t.goodsList=o.body.rows,t.total=o.body.total)})},handleCurrentChange:function(t){this.searchForm.page=t,this.getGoodsList()},search_smt:function(){this.searchForm.page=1,this.getGoodsList()},refresh:function(){this.getGoodsList()},showMsg:function(t){this.msgFaile=[];for(var e in t)this.msgFaile.push({msg:t[e]});this.dialogMsg=!0},doAction:function(t){var e=this;this.axios.post(this.myConfig.code.proxy+"/goods-upload/api/goods/upload/cancel",{body:{id:t.id}}).then(function(t){"10000"==t.data.head.code?(e.$message({message:"取消成功",type:"success"}),e.getGoodsList()):e.$message({message:"取消失败",type:"warning"})})},showProgress:function(t){this.progressId=t.id,this.dialogProgress=!0,this.getProgressMsg()},dialogProgressOpen:function(){var t=this;this.progressSetInterval=setInterval(function(){t.getProgressMsg()},2e3)},dialogProgressClose:function(){clearInterval(this.progressSetInterval)},getProgressMsg:function(){var t=this;this.axios.post(this.myConfig.code.proxy+"/goods-upload/api/goods/upload/plan",{body:{id:this.progressId}}).then(function(e){var o=e.data;"10000"==o.head.code&&(t.progressMsg=o.body.message)})},getImgMsg:function(){var t=this;this.axios.post(this.myConfig.code.proxy+"/goods-upload/api/goods/down/img/plan",{body:{id:this.progressId}}).then(function(e){var o=e.data;if("10000"==o.head.code){var s=[];for(var a in o.body.msgRows)s.push({msg:o.body.msgRows[a]});t.msgImgFaile=s}})},showProgressImg:function(t){this.progressId=t.id,this.dialogMsgImg=!0,this.getImgMsg()},getTemplate:function(){window.open("/proxy/goods-upload/api/goods/down/template")}},created:function(){this.getGoodsList()}}},857:function(t,e,o){e=t.exports=o(728)(!0),e.push([t.i,".wrap{padding-right:40px}.wrap-export-import .action{margin:0 5px;cursor:pointer;color:#409eff}.load-import{font-size:12px}.load-import .el-form-item.load-template{margin-left:-65px}.load-import .el-form-item__label,.load-import a{font-size:12px}.table-msg{max-height:500px;overflow-y:auto}.export-tip,.upload-tip{color:#d73435;margin:0 15px}","",{version:3,sources:["D:/mywebstorm/admin-sys/src/components/sys/goods/load-import.vue"],names:[],mappings:"AACA,MACE,kBAAoB,CACrB,AACD,4BACE,aAAe,AACf,eAAgB,AAChB,aAAe,CAChB,AACD,aACE,cAAgB,CACjB,AACD,yCACE,iBAAmB,CACpB,AAID,iDACE,cAAgB,CACjB,AACD,WACE,iBAAkB,AAClB,eAAiB,CAClB,AACD,wBAEE,cAAe,AACf,aAAe,CAChB",file:"load-import.vue",sourcesContent:["\n.wrap {\n  padding-right: 40px;\n}\n.wrap-export-import .action {\n  margin: 0 5px ;\n  cursor: pointer;\n  color: #409EFF;\n}\n.load-import {\n  font-size: 12px;\n}\n.load-import .el-form-item.load-template {\n  margin-left: -65px;\n}\n.load-import .el-form-item__label {\n  font-size: 12px;\n}\n.load-import a {\n  font-size: 12px;\n}\n.table-msg {\n  max-height: 500px;\n  overflow-y: auto;\n}\n.upload-tip,\n.export-tip {\n  color: #d73435;\n  margin: 0 15px;\n}\n"],sourceRoot:""}])},904:function(t,e,o){var s=o(857);"string"==typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);o(729)("feffdf78",s,!0)},953:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"wrap wrap-export-import"},[o("div",{staticClass:"nav-bar clear-fix"},[o("el-breadcrumb",{staticClass:"fl-l",attrs:{separator:">"}},[o("el-breadcrumb-item",[t._v("商品管理")]),t._v(" "),o("el-breadcrumb-item",[t._v("商品模板下载与导入")])],1)],1),t._v(" "),o("div",{staticClass:"content"},[o("el-form",{ref:"form",staticClass:"load-import",attrs:{"label-width":"150px",inline:!0}},[o("el-form-item",{staticClass:"load-template",attrs:{label:"批量上传模板"}},[o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.getTemplate}},[t._v("下载")]),t._v(" "),o("a",{staticClass:"export-tip",attrs:{href:"/goods/upload-help",target:"_blank"}},[t._v("帮助中心")])],1),t._v(" "),o("el-form-item",{attrs:{label:"导入商品"}},[o("el-upload",{staticClass:"upload-demo",attrs:{action:"/proxy/goods-upload/api/goods/upload",accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel","on-success":t.success,"on-error":t.error}},[o("el-button",{attrs:{size:"mini",type:"primary"}},[t._v("导入")]),t._v(" "),o("span",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[o("a",{staticClass:"upload-tip",attrs:{href:"http://s1.pic.intmall.net/file/vendors/goods_import_rules.pdf",download:"goods_import_rules.pdf"}},[t._v("批量上传操作指引")]),t._v("\n            只能导入excel文件\n          ")])],1)],1)],1)],1),t._v(" "),o("div",{staticClass:"goodsImport-info"},[o("p",{staticClass:"txt"},[t._v("商品导入信息")]),t._v(" "),o("div",{staticClass:"search report"},[o("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:t.searchForm,"label-width":"100px"}},[o("el-form-item",{attrs:{label:"文件名称"}},[o("el-input",{attrs:{size:"small"},model:{value:t.searchForm.fileName,callback:function(e){t.$set(t.searchForm,"fileName",e)},expression:"searchForm.fileName"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"处理状态"}},[o("el-select",{attrs:{size:"small",clearable:""},model:{value:t.searchForm.uploadStatus,callback:function(e){t.$set(t.searchForm,"uploadStatus",e)},expression:"searchForm.uploadStatus"}},[o("el-option",{attrs:{value:"0",label:"等待处理"}}),t._v(" "),o("el-option",{attrs:{value:"1",label:"数据处理中"}}),t._v(" "),o("el-option",{attrs:{value:"2",label:"导入完成 "}}),t._v(" "),o("el-option",{attrs:{value:"3",label:"取消 "}}),t._v(" "),o("el-option",{attrs:{value:"4",label:"上传失败 "}})],1)],1),t._v(" "),o("el-form-item",{staticClass:"search-btn"},[o("el-button",{attrs:{type:"primary"},on:{click:t.search_smt}},[t._v("查询")]),t._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:t.refresh}},[o("i",{staticClass:"iconfont icon-refresh"}),t._v("刷新\n          ")])],1)],1)],1),t._v(" "),o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading2,expression:"loading2"}],staticClass:"report",staticStyle:{width:"100%"},attrs:{data:t.goodsList,stripe:"",border:"","max-height":"520","tooltip-effect":"light","highlight-current-row":""}},[o("el-table-column",{attrs:{label:"上传编号",align:"left",prop:"id","show-overflow-tooltip":"",width:"90",fixed:"left"}}),t._v(" "),o("el-table-column",{attrs:{label:"文件名称",align:"center",prop:"fileName","show-overflow-tooltip":"","min-width":"150"}}),t._v(" "),o("el-table-column",{attrs:{label:"处理状态",align:"center",width:"180",prop:"uploadStatus","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("uploadStatus")(e.row.uploadStatus)))]}}])}),t._v(" "),o("el-table-column",{attrs:{label:"上传时间",align:"center",width:"180",prop:"uploadTime"}}),t._v(" "),o("el-table-column",{attrs:{label:"处理完成时间",align:"center",width:"160",prop:"completeTime"}}),t._v(" "),o("el-table-column",{attrs:{label:"SKU成功条数",align:"center",width:"120",prop:"skuUploadCount","show-overflow-tooltip":""}}),t._v(" "),o("el-table-column",{attrs:{label:"SPU成功条数",align:"center",width:"120",prop:"spuUploadCount","show-overflow-tooltip":""}}),t._v(" "),o("el-table-column",{attrs:{label:"excel大小(kb)",align:"center",width:"120",prop:"excelFileSize","show-overflow-tooltip":""}}),t._v(" "),o("el-table-column",{attrs:{label:"上传失败信息",align:"left",width:"150",prop:"uploadErrorMsg","show-overflow-tooltip":"",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("span",{staticClass:"action",on:{click:function(o){t.showMsg(e.row.uploadErrorMsg)}}},[t._v("描述信息")]),t._v(" "),1==e.row.uploadStatus||2==e.row.uploadStatus||4==e.row.uploadStatus?o("span",{staticClass:"action",on:{click:function(o){t.showProgressImg(e.row)}}},[t._v("图片信息")]):t._e()]}}])}),t._v(" "),o("el-table-column",{attrs:{label:"操作",align:"left",width:"120",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[0==e.row.uploadStatus?o("span",{staticClass:"action",on:{click:function(o){t.doAction(e.row)}}},[t._v("取消")]):t._e(),t._v(" "),1==e.row.uploadStatus?o("span",{staticClass:"action",on:{click:function(o){t.showProgress(e.row)}}},[t._v("进度")]):t._e()]}}])})],1),t._v(" "),o("el-dialog",{staticClass:"dialog-load-import",attrs:{title:"上传失败信息",visible:t.dialogMsg},on:{"update:visible":function(e){t.dialogMsg=e}}},[o("el-table",{attrs:{data:t.msgFaile,"max-height":"520",stripe:"","tooltip-effect":"light","highlight-current-row":""}},[o("el-table-column",{attrs:{type:"index",width:"70"}}),t._v(" "),o("el-table-column",{attrs:{property:"msg",label:"异常信息"}})],1)],1),t._v(" "),o("el-dialog",{staticClass:"dialog-load-import",attrs:{title:"上传图片信息",visible:t.dialogMsgImg},on:{"update:visible":function(e){t.dialogMsgImg=e}}},[o("div",{staticStyle:{color:"#FA4640"}},[t._v("图片处理耗时较长，查看异常信息需实时刷新")]),t._v(" "),o("el-table",{attrs:{data:t.msgImgFaile,"max-height":"520",stripe:"","tooltip-effect":"light","highlight-current-row":""}},[o("el-table-column",{attrs:{type:"index",width:"70"}}),t._v(" "),o("el-table-column",{attrs:{property:"msg",label:"异常信息"}})],1)],1),t._v(" "),Math.ceil(t.total/t.myConfig.pageRows)>1?o("div",{staticClass:"pagination"},[o("el-pagination",{attrs:{"current-page":t.searchForm.page.page,"page-size":t.searchForm.page.pageSize,layout:"total, prev, pager, next, jumper",total:t.total},on:{"current-change":t.handleCurrentChange}})],1):t._e()],1),t._v(" "),o("el-dialog",{attrs:{title:"进度",visible:t.dialogProgress,size:"tiny"},on:{"update:visible":function(e){t.dialogProgress=e},open:t.dialogProgressOpen,close:t.dialogProgressClose}},[o("span",[t._v(t._s(t.progressMsg))])])],1)},staticRenderFns:[]}}});
//# sourceMappingURL=9.92ed7329135ac068abc5.js.map